local XKHub = window:Tab("关于", "7733774602")
local XK = XKHub:section("CHAIN [ENRAGED] 战斗系统", true)

XK:Label("脚本作者: 冷秋")
XK:Label("游戏: CHAIN [ENRAGED]")
XK:Label("版本: AXIN HUB X959")

XK:Button(
    "启动所有战斗功能",
    function()
        getgenv().AXIN_CONFIG.AutoAttack = true
        getgenv().AXIN_CONFIG.AutoBlock = true
        getgenv().AXIN_CONFIG.AutoDodge = true
        getgenv().AXIN_CONFIG.InfiniteStamina = true
        getgenv().AXIN_CONFIG.InfiniteComboStamina = true
        
        CombatSystem.StartAutoAttack()
        CombatSystem.StartAutoBlock()
        CombatSystem.StartAutoDodge()
        ResourceSystem.StartInfiniteStamina()
        
        print("🎉 所有战斗功能已启动!")
    end)

XK:Button(
    "停止所有功能",
    function()
        CombatSystem.StopAll()
        ResourceSystem.StopAll()
        
        getgenv().AXIN_CONFIG.AutoAttack = false
        getgenv().AXIN_CONFIG.AutoBlock = false
        getgenv().AXIN_CONFIG.AutoDodge = false
        getgenv().AXIN_CONFIG.InfiniteStamina = false
        getgenv().AXIN_CONFIG.InfiniteComboStamina = false
        
        print("🛑 所有功能已停止!")
    end)

XK:Toggle("自动攻击", "", false, function(state)
    getgenv().AXIN_CONFIG.AutoAttack = state
    if state then
        CombatSystem.StartAutoAttack()
        print("⚔️ 自动攻击已启用")
    else
        if CombatSystem.Connections.Attack then
            CombatSystem.Connections.Attack:Disconnect()
            CombatSystem.Connections.Attack = nil
        end
        print("⚔️ 自动攻击已禁用")
    end
end)

XK:Toggle("自动格挡", "", false, function(state)
    getgenv().AXIN_CONFIG.AutoBlock = state
    if state then
        CombatSystem.StartAutoBlock()
        print("🛡️ 自动格挡已启用")
    else
        if CombatSystem.Connections.Block then
            CombatSystem.Connections.Block:Disconnect()
            CombatSystem.Connections.Block = nil
        end
        print("🛡️ 自动格挡已禁用")
    end
end)

XK:Toggle("自动躲避", "", false, function(state)
    getgenv().AXIN_CONFIG.AutoDodge = state
    if state then
        CombatSystem.StartAutoDodge()
        print("🎯 自动躲避已启用")
    else
        if CombatSystem.Connections.Dodge then
            CombatSystem.Connections.Dodge:Disconnect()
            CombatSystem.Connections.Dodge = nil
        end
        print("🎯 自动躲避已禁用")
    end
end)

XK:Slider("攻击范围", "", 12, 5, 20, false, function(v)
    getgenv().AXIN_CONFIG.AttackRange = v
    print("🎯 攻击范围设置为: " .. v)
end)

XK:Slider("攻击速度", "", 0.8, 0.1, 2.0, false, function(v)
    getgenv().AXIN_CONFIG.AttackSpeed = v
    print("⚡ 攻击速度设置为: " .. v)
end)

local XKHub = window:Tab("其他", "78892482588180")
local XKNB = XKHub:section("资源管理", true)

XKNB:Label("无限资源系统")

XKNB:Toggle("无限体力", "", false, function(state)
    getgenv().AXIN_CONFIG.InfiniteStamina = state
    if state then
        ResourceSystem.StartInfiniteStamina()
        print("💪 无限体力已启用")
    else
        ResourceSystem.StopAll()
        print("💪 无限体力已禁用")
    end
end)

XKNB:Toggle("无限攻击资源", "", false, function(state)
    getgenv().AXIN_CONFIG.InfiniteComboStamina = state
    if state then
        ResourceSystem.StartInfiniteComboStamina()
        print("🔥 无限攻击资源已启用")
    else
        print("🔥 无限攻击资源已禁用")
    end
end)

XKNB:Slider("格挡范围", "", 8, 5, 15, false, function(v)
    getgenv().AXIN_CONFIG.BlockRange = v
    print("📏 格挡范围设置为: " .. v)
end)

XKNB:Slider("躲避范围", "", 10, 5, 15, false, function(v)
    getgenv().AXIN_CONFIG.DodgeRange = v
    print("📏 躲避范围设置为: " .. v)
end)

XKNB:Dropdown("目标优先级", "", { "最近目标", "最低血量", "最高威胁" }, function(s)
    getgenv().AXIN_CONFIG.TargetPriority = s
    print("🎯 目标优先级设置为: " .. s)
end)

XKNB:Textbox("调试信息", "", "输入命令", function(s)
    if s == "status" then
        print("=== 系统状态 ===")
        for key, value in pairs(getgenv().AXIN_CONFIG) do
            print(key .. ": " .. tostring(value))
        end
    elseif s == "events" then
        print("=== 事件检测 ===")
        local events = {"Attack", "Block", "Dodge", "Combat"}
        for _, event in pairs(events) do
            local found = ReplicatedStorage:FindFirstChild(event)
            print(event .. ": " .. (found and "✅" or "❌"))
        end
    else
        print("📝 输入命令: " .. s)
    end
end)
